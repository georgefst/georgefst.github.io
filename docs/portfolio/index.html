<!DOCTYPE HTML>
<html><head><title>George Thomas</title><link rel="stylesheet" href="/style.css"></head><body><h2>Monpad</h2>
<ul>
  <li>
    <button onclick='window.setMonpadLayout("default")'>
      default layout
    </button>
  </li>
  <li>
    <button onclick='window.setMonpadLayout("full")'>
      full gamepad layout
    </button>
  </li>
  <li>
    <button onclick='window.setMonpadLayout("mouse")'>
      mouse layout
    </button>
  </li>
  <li>
    <button onclick='window.sendMonpadUpdate({"ShowElement": "Red"})'>
      show red button
    </button>
  </li>
  <li>
    <button onclick='window.sendMonpadUpdate({"HideElement": "Red"})'>
      hide red button
    </button>
  </li>
</ul>
<iframe
  id="monpad"
  title="Monpad"
  width="400"
  height="200"
  src="/monpad.html?username=George"
>
</iframe>
<pre id="monpad-output"></pre>
<pre id="monpad-layout"></pre>
<script>
const maxLines = 10
const outputElement = document.getElementById("monpad-output")
document.addEventListener("monpad-client-update", e => {
  outputElement.textContent = outputElement.textContent.split("\n")
    .slice(-maxLines+1).join("\n")
    + (outputElement.textContent ? '\n' : '') + e.detail
})
window.sendMonpadUpdate = detail => document.dispatchEvent(new CustomEvent("monpad-server-update", {detail}))
window.setMonpadLayout = s => {
  window.fetch(`/portfolio/monpad/layouts/${s}.dhall`).then(r => r.text().then(t => {
      document.getElementById("monpad-layout").textContent = t
    }))
  // TODO eventually Monpad will have a Haskell Wasm frontend which will support Dhall input directly
  // then we can support actual freeform user input, and use `SetLayout` instead of `SwitchLayout`
  window.sendMonpadUpdate({"SwitchLayout": `${s}`})
}
</script></body></html>